---
name: 本家同期
description: "本家リポジトリから最新の更新を取得し、新規・変更ファイルを自動翻訳します"
category: 同期
complexity: advanced
personas: [translation-agent-jp]
namespace: jp
---

# /jp:本家同期 - 上流リポジトリ同期・翻訳

> **コンテキストフレームワーク注記**: このコマンドは本家リポジトリとの同期を行い、新規・更新されたファイルを自動的に翻訳します。

## コンテキストトリガーパターン
```
/jp:本家同期 [--preview] [--force]
```
**使用法**: 引数なしで実行すると完全同期。`--preview` で同期予定内容の確認、`--force` で競合時の強制同期。

## 動作フロー
1.  **上流確認**: upstream リモートの設定確認と接続テスト。
2.  **フェッチ実行**: `git fetch upstream` で最新変更を取得。
3.  **差分分析**: 本家との差分を分析し、新規・更新・削除ファイルを特定。
4.  **マージ処理**: 競合を解決しながら upstream/master をマージ。
5.  **新規ファイル検出**: 翻訳対象となる新規英語ファイルを検出。
6.  **自動翻訳実行**: 検出されたファイルを translation-agent-jp で翻訳。
7.  **状況レポート**: 同期結果と翻訳状況を詳細レポート。

## 同期処理の詳細

### 1. 上流リポジトリ設定確認
```bash
git remote -v
git fetch upstream --dry-run
```

### 2. 変更検出アルゴリズム
- **新規ファイル**: upstream に存在するが local に存在しない `.md` ファイル
- **更新ファイル**: upstream と local でハッシュが異なるファイル
- **削除ファイル**: local に存在するが upstream で削除されたファイル

### 3. マージ戦略
- **Fast-forward**: 競合がない場合の高速マージ
- **Three-way merge**: 競合がある場合の三方向マージ
- **Manual resolution**: 自動解決できない競合の手動対応

## 使用例

### 同期予定内容の確認
```
/jp:本家同期 --preview
```
出力例:
```
【本家同期プレビュー】
上流リポジトリ: https://github.com/original/SuperClaude_Framework.git
最新コミット: a1b2c3d (2024-01-15 10:30:00)

== 変更予定 ==
新規ファイル (3件):
  ✓ SuperClaude/Commands/new-feature.md
  ✓ Docs/Advanced/performance.md  
  ✓ SuperClaude/Agents/ai-advisor.md

更新ファイル (2件):
  📝 README.md (更新: 2024-01-14)
  📝 SuperClaude/Commands/analyze.md (更新: 2024-01-13)

削除ファイル (1件):
  ❌ SuperClaude/Commands/deprecated.md

== 翻訳対象 ==
新規翻訳: 3ファイル
再翻訳: 2ファイル
```

### 完全同期の実行
```
/jp:本家同期
```
出力例:
```
【本家同期開始】
✓ 上流接続確認完了
✓ 最新変更フェッチ完了
✓ マージ処理完了 (競合: 0件)
✓ 新規ファイル検出: 3件
✓ 自動翻訳実行中... ████████████ 100%

== 同期結果 ==
✓ 同期完了: 6ファイル
✓ 翻訳完了: 5ファイル
✗ 翻訳エラー: 0ファイル

詳細ログ: SuperClaude/Translations/sync_log.json
```

### 競合時の強制同期
```
/jp:本家同期 --force
```

## 競合解決戦略

### 自動解決可能な競合
- **ドキュメント追加**: 新規セクションの追加
- **用語更新**: 用語集に基づく用語の統一
- **フォーマット調整**: Markdown フォーマットの統一

### 手動対応が必要な競合
- **内容の大幅変更**: 翻訳済みファイルの構造変更
- **削除と更新の競合**: 削除されたファイルがローカルで更新されている
- **バイナリファイルの競合**: 画像やPDFファイルの競合

## 高度な機能

### インテリジェント翻訳
- **差分翻訳**: 変更部分のみを再翻訳
- **文脈保持**: 既存翻訳との整合性を保持
- **品質評価**: 翻訳品質の自動評価と改善提案

### 履歴管理
- **同期履歴**: 過去の同期操作の完全な履歴
- **翻訳履歴**: ファイル単位の翻訳バージョン管理
- **競合履歴**: 解決した競合の詳細記録

### 通知機能
- **重要な変更**: 設定ファイルやコア機能の変更通知
- **翻訳品質**: 品質低下や不整合の警告
- **同期失敗**: エラー発生時の詳細通知

## 安全機能

### バックアップ
- **自動バックアップ**: 同期前の自動バックアップ作成
- **ロールバック**: 問題発生時の即座な復元
- **スナップショット**: 主要な同期ポイントでのスナップショット

### 検証機能
- **整合性チェック**: 同期後のファイル整合性確認
- **翻訳品質チェック**: 自動翻訳結果の品質評価
- **リンク検証**: 内部リンクの有効性確認

## 設定オプション

### 同期設定
```json
{
  "upstream_url": "https://github.com/original/SuperClaude_Framework.git",
  "auto_translate": true,
  "conflict_strategy": "auto",
  "backup_enabled": true,
  "notification_level": "important"
}
```

### 翻訳設定
```json
{
  "translation_mode": "differential",
  "quality_threshold": 0.8,
  "preserve_formatting": true,
  "custom_glossary": "SuperClaude/Translations/glossary_jp.json"
}
```

## 関連コマンド
- `/jp:一括翻訳` - 同期後の完全再翻訳
- `/jp:翻訳確認` - 同期結果の確認
- `/jp:状況表示` - 同期・翻訳プロジェクトの全体状況